#!/usr/bin/env ruby -w

# for testing, we pass an explicit - temporary - config file path through --file and/or --global_file
in_test_mode = ARGV.include?('--file')

$: << File.expand_path(File.join(File.dirname(__FILE__), '..', 'lib' ))
require 'ppgit/commands'


if ARGV.empty?
  do_ppgit_show_usage_message()

else
  LOCAL_CONFIG_FILE  = in_test_mode ? config_file_part('--file'       ) : nil
  GLOBAL_CONFIG_FILE = in_test_mode ? config_file_part('--global_file') : '--global'

  if emailroot = argv_value_of('--email_root')
    do_ppgit_emailroot(emailroot)
  end

  if ARGV == %w(info)
    do_ppgit_info()

  elsif ARGV == %w(clear)
    do_ppgit_clear
    do_ppgit_info()

  elsif [2, 3].include?(ARGV.length)
    do_ppgit_set_pair_as_a_user(user_1=ARGV[0], user_2=ARGV[1], pair_email=ARGV[2])
    do_ppgit_info()

  else
    do_ppgit_show_usage_message()

  end
end